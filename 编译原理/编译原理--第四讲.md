# 							编译原理--第四讲

# 																		词法分析1

## 4.1词法分析概述

### 			1、==词法分析==的任务：从左至右逐个字符地对源程序进行扫描，产生一个个单词符号

### 			2、词法分析器（Lexical Analyzer）：扫描器（Scanner），执行词法分析的程序

### 			3、功能：输入源程序、输出单词符号

### 			4、单词符号的种类：

#### 						==基本字==：如 begin、repeat、for ......

#### 						==标识符==：用来表示各种名字，如变量名、数组名和过程名

#### 						==常数==：各种类型的常数

#### 						==运算符==：+、-、*、/ ......

#### 						==界符==：逗号、分号、括号和空白

### 			5、输出的单词符号的表示形式：==（单词种别，单词自身的值）==

### 			6、单词种别通常用整数编码表示：

#### 						1、若一个种别只有一个单词符号，则种别编码就代表该单词符号。假定==基本字==、==运算符==、和==界符==都是一符一种

#### 						2、若一个种别有多个单词符号，则对于每个单词符号，给出种别==编码==和==自身的值==。

##### 								1、==标识符==单列一种：标识符自身的值表示成按机器字节划分的内部码

##### 								2、==常数==按类型分种：常数的值则表示成标准的二进制形式

### 			7、词法分析器作为一个独立子程序：结构清晰简洁，有利于集中考虑词法分析一些枝节问题。但不一定作为单独的一==遍==，而是处理为一个子程序。

## 4.2词法分析器的设计

### 			8、词法分析器的结构：1、预处理子程序	2、输入缓冲区	3、扫描器	4、扫描缓冲区

#### 									基本过程：

##### 												1、扫描器调用预处理子程序

##### 												2、预处理子程序将源码输入到输入缓冲区

##### 												3、预处理子程序从输入缓冲区读取源代码，进行文本预处理（主要是1、剔除无用的空白、跳格、回车和换行的编辑性字符	2、区分标号区、连接续行和给出句末符等）

##### 												4、规范性更好的文本送到扫描缓冲区

##### 												5、预处理子程序返回扫描器，扫描器继续从缓冲区中读取预处理后的文本，根据词法规则识别出单词符号 

#### 									扫描缓冲区：起点指示器，搜索指示器。为了防止单词不被完整读入，将扫描缓冲区一分为二。如果一个单词的长度超过了一个半区，那么搜索指示器会进入另一半区进行搜索。这里值得一提的是，两个半区没有前后之分。也就是当一个单词的前一部分占满了后半区，那么单词剩下的会被读入到前半区。

### 			9、单词符号的识别：超前搜索

#### 									1、基本字识别

#### 									2、==标识符==的识别：字母开头的字母数字串，后跟界符或算符

#### 									3、==常数==识别：识别出算术常数并将其转变为二进制内码表示

#### 									4、==算符==和==界符==的识别：把多字符组成的算符和界符拼合成一个单词符号

### 			10、几点限制-----不必使用超前搜索：

#### 									1、==所有基本字都是保留字==，用户不能用它们作自己的标识符

#### 									2、==基本字作为特殊的标识符来处理==，使用保留字表

#### 									3、如果基本字、标识符和常数（或标号）之间没有确定的运算符或界符作间隔，则必须==使用一个空白符作间隔==

### 			11、状态转换图

#### 									1、==结点==代表==状态==，用圆圈表示

#### 									2、状态之间用==箭弧==连结，箭弧上的标记（字符）代示射出结点状态下可能出现的输入==字符==或==字符类==

#### 									3、一张转换图只包含==有限个状态==，其中有一个为==初态==用箭头标识出来，至少有一个==终态==用双圈表示（如果双圈上有*号，代表最后读入的字符不被记录，也就是不被算入单词内）

#### 									4、状态转换图可用于识别（或接受）一定的字符串：

##### 												1、若存在一条从初态到某一终态的道路，且这条路上所有弧上的标记符连接成的字等于$\alpha$,则称$\alpha$被该状态转换图所==识别==（==接受==）

### 			12、状态转换图的代码实现：==每个状态结点对应一小段程序==

#### 									1、不含回路的分叉结点

![](https://github.com/FreedomLove7/Sophomore-professional-semester-study-notes/blob/master/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86--%E5%9B%BE%E7%89%87%E5%BA%93/%E6%88%AA%E5%B1%8F2020-02-0723.08.57.jpg)

#### 									2、含有回路的状态结点

![](https://github.com/FreedomLove7/Sophomore-professional-semester-study-notes/blob/master/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86--%E5%9B%BE%E7%89%87%E5%BA%93/%E6%88%AA%E5%B1%8F2020-02-0723.09.52.jpg)

##### 									3、终态结点

![](https://github.com/FreedomLove7/Sophomore-professional-semester-study-notes/blob/master/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86--%E5%9B%BE%E7%89%87%E5%BA%93/%E6%88%AA%E5%B1%8F2020-02-0723.10.55.jpg)

### 			13、全局变量和过程

#### 									1、==ch==：字符变量，存放最新读入的源程序字符

##### 									2、==strToken==：字符数组，存放构成单词符号的字符串

##### 									3、==GetChar==：子程序过程，把下一个字符读入到ch中

##### 									4、==GetBC==：子程序过程，跳过空白符，直至ch中读入一非空白符

##### 									5、==Concat==：子程序，把ch中的字符连接到strToken

##### 									6、==IsLetter和IsDisgital==：布尔函数，判断ch中字符是否为字母和数字

​									7、==Reserve==：整型函数，对于strToken中的字符串集找保留字表，若它是保留字则给出它的编码，否则回送0

​									8、==Retract==：子程序，把搜索指针回调一个字符位置

​									9、==InsertId==：整型函数，将strToken中的标识符插入符号表，返回符号表指针

​									10、==InsertConst==：整型函数过程，将strToken中的常数插入常数表，返回常数表指针

### 			14、词法分析器的实现

#### 									单词规范表

![](https://github.com/FreedomLove7/Sophomore-professional-semester-study-notes/blob/master/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86--%E5%9B%BE%E7%89%87%E5%BA%93/%E6%88%AA%E5%B1%8F2020-02-0723.37.18.jpg)

#### 									过程实现

![](https://github.com/FreedomLove7/Sophomore-professional-semester-study-notes/blob/master/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86--%E5%9B%BE%E7%89%87%E5%BA%93/%E6%88%AA%E5%B1%8F2020-02-0723.30.32.jpg)

![](https://github.com/FreedomLove7/Sophomore-professional-semester-study-notes/blob/master/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86--%E5%9B%BE%E7%89%87%E5%BA%93/%E6%88%AA%E5%B1%8F2020-02-0723.34.44.jpg)

![](https://github.com/FreedomLove7/Sophomore-professional-semester-study-notes/blob/master/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86--%E5%9B%BE%E7%89%87%E5%BA%93/%E6%88%AA%E5%B1%8F2020-02-0723.36.17.jpg)

### 			15、将状态转图的代码一般化

#### 									1、变量curState用于保存现有的状态

#### 									2、用二维数组表示状态图：stateTrans[state][ch]

![](https://github.com/FreedomLove7/Sophomore-professional-semester-study-notes/blob/master/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86--%E5%9B%BE%E7%89%87%E5%BA%93/%E6%88%AA%E5%B1%8F2020-02-0723.42.57.jpg)

## 4.3小结

### 			词法分析器的功能

#### 									输入源程序，输出单词符号

### 			词法分析器的设计

#### 									1、给出程序设计语言的单词规范表------单词表

#### 									2、对照单词表设计识别该语言所有单词的状态转换图

#### 									3、根据状态转换图编写词法分析程序
